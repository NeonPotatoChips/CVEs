# CVE-2025-31161 
Impacts CrushFTP 10(Including) < 10.8.4(Excluding) and CrushFTP 11(Including) < 11.3.1(Excluding)
CVSSv3.1 Score 9.8/10

## Summarized version of Rapid7 analysis
When a request is made to the FTP server, the server checks for ```AWS4-HMAC``` value in the Authorization header as a authentication type. If this type is present, the server will then attempt to extract a username value, followed by a ```=``` character, and then a ```/``` character. An example is provided by AWS Documentation. 
```Authorization: AWS4-HMAC-SHA256 Credential=AKIAIOSFODNN7EXAMPLE/20130524/us-east-1/s3/aws4_request,SignedHeaders=host;range;x-amz-date,Signature=fe5f80f77d5fa3beca038a248ff027d0445342fe2855ddc963176630326f1024``` In this value "AKIAIOSFODNN7EXAMPLE" would be the extracted username.

A variable called lookup_user_pass is set to ```true```, and another function called ```this.thisSession.login_user_pass()``` is called. ```login_user_pass()``` is defined as 
``` login_user_pass(boolean anyPass, boolean doAfterLogin, String user_name, String user_pass) ```

## Other resources
* https://nvd.nist.gov/vuln/detail/CVE-2025-31161
* https://www.cve.org/CVERecord?id=CVE-2025-31161
* https://attackerkb.com/topics/k0EgiL9Psz/cve-2025-2825/rapid7-analysis